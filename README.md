## Запуск проект

Запуск проекта:
```
docker-compose up -d
```
Применить миграции:
```
docker exec weather_api alembic upgrade head
```

Переменные окружения в `.env.example`. Необходимо создать файл `.env` и перенести туда все конфиги. Для упрощения,
оставил там API ключ `OpenWeatherMap`

### Airflow DAGS
Находятся в `airflow/dags`

DAG запускается каждый день в 12 по UTC

Веб морда находится по адресу `localhost:8080` 
Логин: `airflow` Пароль: `airflow`

### Alembic миграции
Находятся в `api/alembic/versions`

### FastAPI приложение

Базовый урл: `http://localhost:1337`

Swagger: `http://localhost:1337/docs`

Находится в `api/`

Модели БД в `api/database/models`

Конфиги в `api/config/`

Добавил кеширование запросов с помощью Redis `/api/utils/cache.py`

## Задача для собеседования: Система сбора и анализа данных о погоде

Цель:
Разработать микросервис для сбора данных о погоде, их хранения, анализа и автоматизации процессов.  
Стек: Python, PostgreSQL, FastAPI, Apache Airflow.

---

Требования:

1. Работа с PostgreSQL

- Создайте таблицу `weather_data` с полями:  
  `id`, `city` (название города), `date` (дата замера), `temperature` (температура в °C), `humidity` (влажность в %).
- Используйте SQLAlchemy2 для работы с базой.
- Настройте Alembic для миграций.

2. Python + Apache Airflow

- Напишите Python-скрипт, который получает текущие погодные данные для трех городов (например, Москва, Лондон, Токио)
  через OpenWeatherMap API(https://openweathermap.org/api) (или любой аналог).
- Сохраните данные в таблицу `weather_data`.

- Создайте DAG, который:
    - Ежедневно запускает скрипт сбора данных.
    - Проверяет, что за последние 24 часа в таблице появились новые записи (в случае отсутствия — отправляет alert в
      лог).

ВАЖНО: Для работы с базой должен быть использован имеено SQLAlchemy2.

3. FastAPI

- Реализуйте два эндпоинта:
    - `GET /weather` — возвращает данные за указанный диапазон дат и город (
      параметры: `start_date`, `end_date`, `city`).
    - `GET /stats` — возвращает среднюю температуру и влажность за период для выбранного города.
- Добавьте Swagger-документацию.
- Используйте асинхронные запросы к базе данных.

4. Дополнительно (по желанию)

- Напишите простые тесты для API (pytest).
- Добавьте кэширование для эндпоинтов (например, Redis).
- Контейнеризуйте проект с помощью Docker.

---

Ожидаемый результат:

- Репозиторий с кодом, включая:
    - Модели и миграции для PostgreSQL.
    - DAG для Airflow сбора данных.
    - FastAPI-приложение с эндпоинтами.
- Краткая документация по запуску проекта.